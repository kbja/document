# 													G1

## 一、基础概念

Region G1将JVM堆内存分为2048个0-32MB的区域

RememberSet 每个区域都有一个RememberSet，用来标记当前region的哪些对象被其他区域引用。

<font color = "red">对于其他垃圾回收器来说，表示的是年轻代的对象被老年代引用</font>

## 二、回收过程

### 年轻代GC

1. 更新RSet（RSet不会实时更新，会放到一个队列中，在gc时合并处理）
2. 扫描GC-Roots，其中包含RSet中的对象
3. 复制对象（e -> s，s->o，s中age不够的，age++；如果s放不下，直接放到o）
4. 处理引用，清空相应区域。

### 老年代并发标记

1. 初始标记 标记GC-Roots可达对象，STW，同时触发youngGc
2. 跟区域扫描 标记s代对象引用
3. 并发标记（和application并行） 如果发现该region都是垃圾，则直接回收；否则计算存活对象比例
4. 再次标记 STW，修正上一步结果
5. 独占清理 STW 按照存活对象比例排序，识别可以混合回收的区域。<font color = "red">此时不会进行回收</font>

### 混合回收

1. JVM分多次对old进行回收，每次回收触发一次youngGc
2. 按照时间配置进行回收，复制算法。对老年代和年轻代都是一样的。
3. 采用复制算法进行回收，如果空间不足，会触发fullGC

当上面三种无法满足时，会触发full GC



